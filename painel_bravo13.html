<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Bravo13</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #f5f5f5;
    margin: 0;
    padding: 0;
  }

  h1 {
    text-align: center;
    margin: 20px 0;
  }

  #painel {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  form {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    background: #222;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
  }

  input, select {
    padding: 8px;
    border: none;
    border-radius: 4px;
  }

  button {
    padding: 8px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    background: #0b5ed7;
    color: white;
  }

  button:hover {
    background: #084298;
  }

  table {
    width: 90%;
    border-collapse: collapse;
    background: #1c1c1c;
  }

  th, td {
    padding: 8px;
    text-align: center;
    border-bottom: 1px solid #333;
  }

  tr:hover {
    background: #333;
  }

  .btn-remove {
    background: #dc3545;
  }

  .btn-remove:hover {
    background: #a71d2a;
  }

  .btn-status {
    background: #198754;
  }

  .btn-status:hover {
    background: #146c43;
  }
</style>
</head>
<body>

<h1>üß© Painel Bravo13</h1>

<div id="painel">

  <form id="formTarefa">
    <select id="status">
      <option value="Pendente">Pendente</option>
      <option value="Conclu√≠do">Conclu√≠do</option>
      <option value="Em andamento">Em andamento</option>
    </select>
    <input type="text" id="tarefa" placeholder="Tarefa" required>
    <input type="text" id="responsavel" placeholder="Respons√°vel">
    <input type="text" id="observacao" placeholder="Observa√ß√£o">
    <button type="submit">Adicionar</button>
  </form>

  <table id="tabela">
    <thead>
      <tr>
        <th>Status</th>
        <th>Tarefa</th>
        <th>Respons√°vel</th>
        <th>Observa√ß√£o</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody id="listaTarefas"></tbody>
  </table>

</div>

<script>
const scriptURL = "PASTE_AQUI_SUA_URL_DO_WEB_APP"; // ‚ö†Ô∏è Substitua pela URL publicada do Apps Script

// ====================
// Fun√ß√£o: carregar dados
// ====================
async function carregarTarefas() {
  const res = await fetch(scriptURL);
  const data = await res.json();
  const tbody = document.getElementById("listaTarefas");
  tbody.innerHTML = "";

  if (!data.tarefas || data.tarefas.length === 0) {
    tbody.innerHTML = "<tr><td colspan='5'>Nenhuma tarefa encontrada</td></tr>";
    return;
  }

  data.tarefas.forEach((t, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${t.status}</td>
      <td>${t.tarefa}</td>
      <td>${t.responsavel}</td>
      <td>${t.observacao}</td>
      <td>
        <button class="btn-status" onclick="atualizarStatus(${t.row}, '${t.status}')">‚úî</button>
        <button class="btn-remove" onclick="removerTarefa(${t.row})">üóë</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// ====================
// Adicionar tarefa
// ====================
document.getElementById("formTarefa").addEventListener("submit", async (e) => {
  e.preventDefault();

  const payload = {
    action: "addTask",
    status: document.getElementById("status").value,
    tarefa: document.getElementById("tarefa").value,
    responsavel: document.getElementById("responsavel").value,
    observacao: document.getElementById("observacao").value
  };

  await fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(payload)
  });

  e.target.reset();
  carregarTarefas();
});

// ====================
// Atualizar status
// ====================
async function atualizarStatus(row, atual) {
  const novo = atual === "Conclu√≠do" ? "Pendente" : "Conclu√≠do";
  const payload = {
    action: "updateTaskStatus",
    row: row,
    status: novo
  };

  await fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(payload)
  });

  carregarTarefas();
}

// ====================
// Remover tarefa
// ====================
async function removerTarefa(row) {
  if (!confirm("Deseja realmente remover esta tarefa?")) return;

  const payload = {
    action: "deleteTask",
    row: row
  };

  await fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(payload)
  });

  carregarTarefas();
}

// ====================
// Inicializar
// ====================
carregarTarefas();
</script>

</body>
</html>

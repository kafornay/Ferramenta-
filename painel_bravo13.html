<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Bravo13</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #121212;
  color: #fff;
  margin: 0;
  padding: 20px;
}
h1 {
  text-align: center;
  color: #00ff99;
}
.container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 10px;
  margin-bottom: 20px;
}
input, select, button, textarea {
  width: 100%;
  padding: 6px;
  border-radius: 6px;
  border: none;
  margin-top: 4px;
}
button {
  background-color: #00ff99;
  color: #000;
  cursor: pointer;
  font-weight: bold;
  transition: 0.2s;
}
button:hover {
  background-color: #00cc77;
}
table {
  width: 100%;
  border-collapse: collapse;
}
th, td {
  padding: 8px;
  border-bottom: 1px solid #444;
  text-align: left;
}
.status-badge {
  padding: 3px 8px;
  border-radius: 5px;
  font-size: 0.9em;
}
.status-Conclu√≠do { background: #00cc77; color: #000; }
.status-Pendente { background: #ffcc00; color: #000; }
.status-Cancelado { background: #ff4444; color: #fff; }
</style>
</head>
<body>
<h1>PAINEL BRAVO13</h1>

<div class="container">
  <div>
    <label>Dinheiro Total</label>
    <input id="dinheiro" type="text">
  </div>
  <div>
    <label>Armas</label>
    <input id="armas" type="text">
  </div>
  <div>
    <label>Drogas</label>
    <input id="drogas" type="text">
  </div>
  <div>
    <label>Muni√ß√£o</label>
    <input id="municao" type="text">
  </div>
  <div>
    <label>Dinheiro Sujo</label>
    <input id="dinheiroSujo" type="text">
  </div>
</div>

<button onclick="atualizarPainel()">üíæ Atualizar Painel</button>

<hr>

<h2>Adicionar Tarefa</h2>
<div class="container">
  <div>
    <label>Tarefa</label>
    <input id="tarefa" type="text">
  </div>
  <div>
    <label>Respons√°vel</label>
    <input id="responsavel" type="text">
  </div>
  <div>
    <label>Observa√ß√£o</label>
    <textarea id="observacao"></textarea>
  </div>
</div>

<button onclick="adicionarTarefa()">‚ûï Adicionar</button>

<hr>

<h2>Lista de Tarefas</h2>
<p id="resumo">‚è≥ Carregando dados...</p>
<table id="tabela">
  <thead>
    <tr>
      <th>Status</th>
      <th>Tarefa</th>
      <th>Respons√°vel</th>
      <th>Observa√ß√£o</th>
      <th>A√ß√µes</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxLJAKDj6xrk2pZK2Kst6hGKQZO4OAXx9ZKZIzuT3Qs1Oxv1fKsbpFTQKWTLkLd7DtA7A/exec";

// Carregar dados
async function carregarDados() {
  const resumo = document.getElementById("resumo");
  resumo.innerText = "‚è≥ Carregando...";
  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    if (data.status) {
      document.getElementById("dinheiro").value = data.status.dinheiro || "";
      document.getElementById("armas").value = data.status.armas || "";
      document.getElementById("drogas").value = data.status.drogas || "";
      document.getElementById("municao").value = data.status.municao || "";
      document.getElementById("dinheiroSujo").value = data.status.dinheiroSujo || "";
    }
    atualizarTabela(data.tarefas || []);
    resumo.innerText = "‚úÖ Dados atualizados.";
  } catch (err) {
    resumo.innerText = "‚ö†Ô∏è Erro ao carregar.";
    console.error(err);
  }
}

// Atualizar painel
async function atualizarPainel() {
  const status = {
    dinheiro: document.getElementById("dinheiro").value,
    armas: document.getElementById("armas").value,
    drogas: document.getElementById("drogas").value,
    municao: document.getElementById("municao").value,
    dinheiroSujo: document.getElementById("dinheiroSujo").value
  };
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ action: "updateStatus", status })
  });
  carregarDados();
}

// Adicionar tarefa
async function adicionarTarefa() {
  const tarefa = document.getElementById("tarefa").value.trim();
  if (!tarefa) return alert("Digite uma tarefa!");
  const responsavel = document.getElementById("responsavel").value.trim();
  const observacao = document.getElementById("observacao").value.trim();
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ action: "addTask", tarefa, responsavel, observacao })
  });
  document.getElementById("tarefa").value = "";
  document.getElementById("responsavel").value = "";
  document.getElementById("observacao").value = "";
  carregarDados();
}

// Atualizar tabela
function atualizarTabela(tarefas) {
  const tbody = document.querySelector("#tabela tbody");
  tbody.innerHTML = "";
  tarefas.forEach((t, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td><span class="status-badge status-${t.status}">${t.status}</span></td>
      <td>${t.tarefa}</td>
      <td>${t.responsavel}</td>
      <td>${t.observacao}</td>
      <td>
        <button onclick="alterarStatus(${i}, 'Conclu√≠do')">‚úÖ</button>
        <button onclick="alterarStatus(${i}, 'Pendente')">üïì</button>
        <button onclick="alterarStatus(${i}, 'Cancelado')">‚ùå</button>
        <button onclick="removerTarefa(${i})">üóëÔ∏è</button>
      </td>`;
    tbody.appendChild(tr);
  });
}

// Alterar status
async function alterarStatus(index, novoStatus) {
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ action: "updateTaskStatus", index, status: novoStatus })
  });
  carregarDados();
}

// Remover tarefa
async function removerTarefa(index) {
  if (!confirm("Remover esta tarefa?")) return;
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify({ action: "deleteTask", index })
  });
  carregarDados();
}

carregarDados();
</script>
</body>
</html>

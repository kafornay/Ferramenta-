<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Gerador de Encarte - Mercado Couto</title>

<style>
body{
    font-family: Arial, sans-serif;
    margin:0;
    background:#f4f4f4;
}

#painel{
    padding:15px;
    background:#ffffff;
    position:sticky;
    top:0;
    z-index:10;
    border-bottom:3px solid #ff6600;
}

button{
    background:#ff6600;
    color:white;
    border:none;
    padding:10px 15px;
    margin:5px;
    cursor:pointer;
    font-weight:bold;
}

input{
    padding:5px;
    margin:5px;
}

#encarte{
    width:900px;
    margin:20px auto;
    background:white;
    padding:20px;
}

/* CABEÇALHO */
.topo{
    background:#ff6600;
    color:white;
    text-align:center;
    padding:15px;
}

.topo h1{ margin:0; font-size:32px; }
.topo h2{ margin:5px 0 0 0; }

/* PRODUTOS */
.grade{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(200px,1fr));
    gap:15px;
    margin-top:20px;
}

.produto{
    border:2px solid #ff6600;
    padding:10px;
    text-align:center;
}

.produto img{
    width:100%;
    height:140px;
    object-fit:contain;
}

.nome{ font-weight:bold; margin-top:5px; }
.desc{ font-size:13px; color:#555; }

.preco{
    font-size:26px;
    color:#ff0000;
    font-weight:bold;
}

/* RODAPÉ */
.rodape{
    margin-top:20px;
    font-size:12px;
    border-top:2px solid #ccc;
    padding-top:10px;
}
</style>
</head>

<body>

<div id="painel">
    <button onclick="addProduto()">Adicionar Produto</button>
    <button onclick="gerarImagem()">Baixar IMAGEM</button>
    <button onclick="window.print()">Baixar PDF</button>
    <div id="formProdutos"></div>
</div>

<div id="encarte">
    <div class="topo">
        <h1>MERCADO COUTO</h1>
        <h2>PROMOÇÃO RELÂMPAGO</h2>
    </div>

    <div class="grade" id="grade"></div>

    <div class="rodape">
        Ofertas válidas enquanto durarem os estoques.<br>
        Aceitamos cartões e PIX.<br><br>

        <b>Jardim Feo</b><br>
        Rua Américo Berlim, 243 – Barra<br><br>

        <b>Araras</b><br>
        Rua Acre, 484 – Em frente ao Otto de Alencar<br>
        Teresópolis – RJ
    </div>
</div>

<script>
let contador = 0;

function addProduto(){
    if(contador >= 12){
        alert("Limite máximo de 12 produtos");
        return;
    }

    contador++;

    const form = document.createElement("div");
    form.innerHTML = `
        <hr>
        Produto: <input id="nome${contador}">
        Descrição: <input id="desc${contador}">
        Preço: <input id="preco${contador}">
        Imagem URL (ou deixe vazio): <input id="img${contador}">
        <button onclick="renderProduto(${contador})">Inserir</button>
    `;
    document.getElementById("formProdutos").appendChild(form);
}

function renderProduto(id){
    const nome = document.getElementById("nome"+id).value;
    const desc = document.getElementById("desc"+id).value;
    const preco = document.getElementById("preco"+id).value;
    const img = document.getElementById("img"+id).value || "https://via.placeholder.com/150";

    const card = document.createElement("div");
    card.className = "produto";
    card.innerHTML = `
        <img src="${img}">
        <div class="nome">${nome}</div>
        <div class="desc">${desc}</div>
        <div class="preco">R$ ${preco}</div>
    `;

    document.getElementById("grade").appendChild(card);
}

/* GERAR IMAGEM */
function gerarImagem(){
    const node = document.getElementById("encarte");

    const data = new XMLSerializer().serializeToString(node);
    const svg = `
    <svg xmlns="http://www.w3.org/2000/svg" width="900" height="1400">
        <foreignObject width="100%" height="100%">
            ${data}
        </foreignObject>
    </svg>`;

    const blob = new Blob([svg], {type:"image/svg+xml;charset=utf-8"});
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "encarte.png";
    a.click();
}
</script>

</body>
</html>
